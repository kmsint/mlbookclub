parent: [[Работа в jupyter notebook]]

tags: #environment #jupyter #python #ml #magiclines

Magiclines

Документация: https://ipython.readthedocs.io/en/stable/interactive/magics.html

Чтобы посмотреть список магических команд:

```jupyter
%lsmagic
```

![[Screenshot 2023-11-25 at 10.46.45.png]]

Команды делятся на те, которые действуют в той строке, в которой они записаны, они начинаются со знака `%` (inline) и те, которые действуют в пределах всей ячейки `%%` (cell)

Есть команды, которые удобно дублируют команды терминала, например, `pwd`возвращает текущую директорию. Причем, такие команды могут быть предпочтительнее, чем эти же команды, начинающиеся с восклицательного знака `!`, потому что последние действуют только в пределах своего вызова, то есть, например, если вы перешли на директорию выше командой, начинающейся с `!`, то в следующей ячейке (и даже в этой же ячейке) все вернется к предыдущему состоянию, как будто вы не поднимались на директорию выше. Команды же, начинающиеся со знака `%` оставляют результат своего вызова и в последующих ячейках.

![[Screenshot 2023-11-25 at 11.23.35.png]]

![[Screenshot 2023-11-25 at 11.24.37.png]]

`%run` позволяет запустить код из внешнего файла и получить вывод результата в notebook

`%%time` позволяет приблизительно оценить время выполнения кода (код будет запущен один раз)

`%%timeit` позволяет оценить время выполнения кода более точно. Код будет запущен несколько раз, а время усреднено

![[Screenshot 2023-11-25 at 16.06.56.png]]

`%writefile <file_name>` позволяет сохранить содержимое ячейки в файл

`%pycat <file_name.py>` позволяет посмотреть содержимое python-файла

`%who` показывает все переменные в памяти. Если нужны переменные определенного типа, то можно указать этот тип

![[Screenshot 2023-11-25 at 16.14.39.png]]

Переменные можно передавать между блокнотами, для этого используется `%store`, перед этим нужно установить библиотеку `pickleshare`

![[Screenshot 2023-11-25 at 16.19.33.png]]

Чтобы затем использовать эту переменную в другом ноутбуке нужно выполнить эту же команду с аргументом `-r` 

![[Screenshot 2023-11-25 at 20.47.40.png]]

`%html` позволяет вставлять в ячейки блоки с html-разметкой, то есть можно прямо в ячейках использовать возможности HTML

Если установить `line_profiler`, можно смотреть эффективность выполнения кода и удобно искать какие его строки занимают много времени выполнения и потенциально требуют оптимизации. Делается это сначала загрузкой профайлера `%load_ext line_profiler`, а затем вызовом `%lprun -f <any_function> <any_function>()`:

![[Screenshot 2023-11-25 at 21.34.09.png]]

`%pprint` позволяет включать или выключать pretty print, позволяющий делать форматирование вывода более "красивым"

`%precision <num>` позволяет управлять выводом чисел. Например, чтобы задать количество знаков после запятой равным 2, нужно выполнить `%precision 2`

![[Screenshot 2023-11-25 at 21.28.17.png]]




